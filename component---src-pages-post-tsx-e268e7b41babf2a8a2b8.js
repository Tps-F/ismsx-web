"use strict";(self.webpackChunkisshin=self.webpackChunkisshin||[]).push([[256],{5997:function(e,t,r){r.r(t),r.d(t,{Head:function(){return i}});var n=r(7294),a=r(5865),o=r(3346);const s=e=>{e.preventDefault();const t=new FormData(e.currentTarget),r=(t.get("workName")||"").toString(),n=(t.get("date")||"").toString(),o=(t.get("URL")||"").toString(),s=(t.get("description")||"").toString(),i=t.getAll("images"),{addWork:l}=(0,a.F)();l({workName:r,date:n,url:o,description:s,images:i}),console.log(i),alert(`work: ${i}`)};t.default=()=>{const{isLogin:e}=(0,o.a)();return e(),n.createElement(n.Fragment,null,n.createElement("div",{className:"min-h-screen py-6 sm:py-8 lg:py-12 font-caviardreams"},n.createElement("div",{className:"mx-auto max-w-screen-2xl px-4 md:px-8"},n.createElement("div",{className:"mb-10 md:mb-16"},n.createElement("h2",{className:"mb-4 text-center text-2xl font-bold text-gray-800 md:mb-6 lg:text-3xl"},"仕事の追加よー")),n.createElement("form",{className:"mx-auto grid max-w-screen-md gap-4 sm:grid-cols-2",onSubmit:s},n.createElement("div",{className:"sm:col-span-2"},n.createElement("label",{className:"mb-2 inline-block text-sm text-gray-800 sm:text-base"},"仕事名"),n.createElement("input",{name:"workName",className:"w-full rounded border px-3 py-2 text-gray-800 outline-none ring-indigo-300 transition duration-100 focus:ring"})),n.createElement("div",null,n.createElement("label",{className:"mb-2 inline-block text-sm text-gray-800 sm:text-base"},"いつのか(日付順で並び替えてる)"),n.createElement("input",{name:"date",type:"datetime-local",className:"w-full rounded border bg-white px-3 py-2 text-gray-800 outline-none ring-indigo-300 transition duration-100 focus:ring"})),n.createElement("div",null,n.createElement("label",{className:"mb-2 inline-block text-sm text-gray-800 sm:text-base"},"遷移先URL"),n.createElement("input",{name:"URL",className:"w-full rounded border bg-gray-50 px-3 py-2 text-gray-800 outline-none ring-indigo-300 transition duration-100 focus:ring"})),n.createElement("div",{className:"sm:col-span-2"},n.createElement("label",{className:"mb-2 inline-block text-sm text-gray-800 sm:text-base"},"サムネ用(3枚までかなー)"),n.createElement("input",{name:"images",type:"file",multiple:!0,accept:".png,.jpg,.webp,.gif",className:"w-full rounded border bg-gray-50 px-3 py-2 text-gray-800 outline-none ring-indigo-300 transition duration-100 focus:ring"})),n.createElement("div",{className:"flex items-center justify-between sm:col-span-2"},n.createElement("button",{type:"submit",className:"inline-block rounded-lg bg-indigo-500 px-8 py-3 text-center text-sm font-semibold text-white outline-none ring-indigo-300 transition duration-100 hover:bg-indigo-600 focus-visible:ring active:bg-indigo-700 md:text-base"},"Send"))))))};const i=()=>n.createElement("title",null,"isshin — Works")},3346:function(e,t,r){r.d(t,{a:function(){return o}});var n=r(4160),a=r(5505);const o=()=>({loginWithPassword:async(e,t)=>{try{const{data:r,error:n}=await a.O.auth.signInWithPassword({email:e,password:t});if(n)throw new Error(n.message);return r}catch(r){throw console.error(r),r}},isLogin:async()=>{try{const{data:{user:e},error:t}=await a.O.auth.getUser();t&&(0,n.c4)("/login")}catch(e){console.error(e)}}})},5865:function(e,t,r){r.d(t,{F:function(){return a}});var n=r(5505);const a=()=>({addWork:async e=>{let{workName:t,date:r,url:a,description:o,images:s}=e;try{var i;const{data:e,error:l}=await n.O.from("works").select("id").order("id",{ascending:!1}).limit(1);if(l)throw new Error(`Error fetching max work id: ${l.message}`);const c=(((null==e||null===(i=e[0])||void 0===i?void 0:i.id)||0)+1).toString();console.log(e),console.log(c);const m=[],g=s.map((async(e,t)=>{const{data:r,error:a}=await n.O.storage.from("assets").upload(`works/${c}/${t}`,e);if(a)throw new Error(`Error uploading image: ${a.message}`);m.push(r)}));await Promise.all(g),console.log(m);const d=m.map((e=>e.fullPath));console.log(d);const{data:u,error:p}=await n.O.from("works").insert([{name:t,date:r,image:d,url:a,description:o}]).select();if(p)throw new Error(`Error uploading works: ${p.message}`);return console.log(u),u}catch(l){return console.error("An error occurred:",l.message),null}},getWorks:async()=>{try{const{data:e,error:t}=await n.O.from("works").select("*");if(t)throw new Error(`Error uploading image: ${t.message}`);return console.log(e),e}catch(e){console.error("An error occurred:",e.message)}}})}}]);
//# sourceMappingURL=component---src-pages-post-tsx-e268e7b41babf2a8a2b8.js.map