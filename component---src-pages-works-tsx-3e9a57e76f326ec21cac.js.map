{"version":3,"file":"component---src-pages-works-tsx-3e9a57e76f326ec21cac.js","mappings":"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","sources":["webpack://isshin/./src/components/header.tsx","webpack://isshin/./src/components/worksGrid.tsx","webpack://isshin/./src/pages/works.tsx","webpack://isshin/./src/utils/database.ts","webpack://isshin/./src/utils/sort.ts"],"sourcesContent":["import React from \"react\";\nimport { useLocation } from \"@reach/router\";\nimport { Link } from \"gatsby\";\ninterface HeaderProps {\n\tcolors?: string[];\n}\n\nconst Header: React.FC<HeaderProps> = ({ colors = [] }) => {\n\tconst location: string = useLocation().pathname.replace(/\\//g, \"\");\n\treturn (\n\t\t<>\n\t\t\t<div className=\"px-4 py-2 text-center text-sm font-semibold text-gray-500 outline-none ring-indigo-300 transition duration-100 hover:bg-gray-100 focus-visible:ring active:bg-gray-200 md:px-8 md:py-3 md:text-base\">\n\t\t\t\t<div\n\t\t\t\t\tclassName={`mb-4 tracking-widest ${\n\t\t\t\t\t\tcolors[0] || \"text-works\"\n\t\t\t\t\t} text-right text-xl`}\n\t\t\t\t>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tto={location === \"\" ? \"works\" : \"/works\"}\n\t\t\t\t\t\tclassName={`${location.includes(\"works\") ? \"bg-textbg\" : \"\"}`}\n\t\t\t\t\t>\n\t\t\t\t\t\tworks\n\t\t\t\t\t</Link>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tclassName={`mb-4 tracking-widest ${\n\t\t\t\t\t\tcolors[1] || \"text-about\"\n\t\t\t\t\t} text-right text-xl`}\n\t\t\t\t>\n\t\t\t\t\t<Link\n\t\t\t\t\t\tto={location === \"\" ? \"about\" : \"/about\"}\n\t\t\t\t\t\tclassName={`${location.includes(\"about\") ? \"bg-textbg\" : \"\"}`}\n\t\t\t\t\t>\n\t\t\t\t\t\tabout\n\t\t\t\t\t</Link>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName={`mb-4 tracking-widest ${\n\t\t\t\t\t\tcolors[2] || \"text-primary\"\n\t\t\t\t\t} text-right text-xl`}\n\t\t\t\t>\n\t\t\t\t\t<a>contact</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n};\n\nexport default Header;\n","import React, { useEffect, useState } from \"react\";\nimport { database } from \"../utils/database\";\nimport { sortByDate, sortByPin } from \"../utils/sort\";\n\nconst WorksGrid = () => {\n\tconst [works, setWorks] = useState<any[]>([]);\n\tconst [selectedWork, setSelectedWork] = useState<any | null>(null);\n\tconst [visibleWorks, setVisibleWorks] = useState<number>(12);\n\n\tuseEffect(() => {\n\t\tconst fetchData = async () => {\n\t\t\ttry {\n\t\t\t\tconst { getWorks } = database();\n\t\t\t\tconst data = await getWorks();\n\t\t\t\tsetWorks(data.sort(sortByDate).sort(sortByPin))\n\t\t\t\tconsole.log(data)\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Error fetching works:\", (error as Error).message);\n\t\t\t}\n\t\t};\n\n\t\tfetchData();\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst handleScroll = () => {\n\t\t\tif (\n\t\t\t\twindow.innerHeight + document.documentElement.scrollTop ===\n\t\t\t\tdocument.documentElement.offsetHeight\n\t\t\t) {\n\t\t\t\tsetVisibleWorks((prevVisibleWorks) => prevVisibleWorks + 12);\n\t\t\t}\n\t\t};\n\n\t\twindow.addEventListener(\"scroll\", handleScroll);\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener(\"scroll\", handleScroll);\n\t\t};\n\t}, []);\n\n\tconst handleImageClick = (work: any) => {\n\t\tsetSelectedWork(work);\n\t};\n\n\tconst closeOverlay = () => {\n\t\tsetSelectedWork(null);\n\t};\n\n\treturn (\n\t\t<div>\n\t\t\t<div\n\t\t\t\tclassName={`grid sm:grid-cols-2 lg:grid-cols-3 ${\n\t\t\t\t\tselectedWork ? \"opacity-10 pointer-events-none\" : \"\"\n\t\t\t\t}`}\n\t\t\t>\n\t\t\t\t{works.slice(0, visibleWorks).map((work) => (\n\t\t\t\t\t<div key={work.id} className=\"relative\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tonClick={() => handleImageClick(work)}\n\t\t\t\t\t\t\tclassName=\"group block w-full overflow-hidden bg-gray-100 relative aspect-video\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={`/ismsx-web/${work.image[0]}.avif`}\n\t\t\t\t\t\t\t\talt={work.name}\n\t\t\t\t\t\t\t\tclassName=\"h-full w-full object-cover object-center transition duration-200\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<span className=\"hover:backdrop-brightness-50 absolute top-0 left-0 right-0 bottom-0 flex flex-col text-white opacity-0 transition-opacity duration-200 hover:opacity-100 p-4\">\n\t\t\t\t\t\t\t\t<span className=\"text-secondary\">\n\t\t\t\t\t\t\t\t\t{work.date.split(\"-\").slice(0, 2).join(\"-\")}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\ttarget=\"blank\"\n\t\t\t\t\t\t\t\t\thref={work.url}\n\t\t\t\t\t\t\t\t\tclassName=\"text-lg text-secondary transition duration-100 hover:text-gray-500 lg:text-xl\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{work.name}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t\t{selectedWork && (\n\t\t\t\t<div\n\t\t\t\t\tonClick={closeOverlay}\n\t\t\t\t\tclassName=\"fixed top-8 left-0 w-full h-full bg-secondary py-2 lg:py-2 font-caviardreams\"\n\t\t\t\t>\n\t\t\t\t\t<div className=\"mx-auto max-w-screen-lg px-4 md:px-8 \">\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<div className=\"relative mb-6 overflow-hidden rounded-lg bg-gray-100 md:mb-8\">\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={`/ismsx-web/${selectedWork.image[0]}.avif`}\n\t\t\t\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t\t\t\t\tclassName=\"h-full w-full object-cover object-center\"\n\t\t\t\t\t\t\t\talt=\"about\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"md:py-8\">\n\t\t\t\t\t\t\t<div className=\"mb-2 md:mb-3\">\n\t\t\t\t\t\t\t\t<span className=\"mb-0.5 inline-block text-gray-500\">\n\t\t\t\t\t\t\t\t\t{selectedWork.date}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<h2 className=\"text-xl font-bold text-gray-800 lg:text-2xl\">\n\t\t\t\t\t\t\t\t\t<a href={selectedWork.url}>{selectedWork.name}</a>\n\t\t\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{/**\n\t\t\t\t\t\t\t * 後で考えるらしいから保留\n\t\t\t\t\t\t\t<div className=\"mt-10 md:mt-16 lg:mt-20\">\n\t\t\t\t\t\t\t\t<div className=\"mb-3 text-lg font-semibold text-gray-800\">\n\t\t\t\t\t\t\t\t\tDescription\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<p className=\"text-gray-500\">\n\t\t\t\t\t\t\t\t\t一応用意した<br/><br/>あああああああああ\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t */}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nexport default WorksGrid;\n","import type { HeadFC, PageProps } from \"gatsby\";\nimport React from \"react\";\n\nimport WorksGrid from \"../components/worksGrid\";\nimport Header from \"../components/header\";\n\nconst WorksPage: React.FC<PageProps> = () => {\n\treturn (\n\t\t<div className=\"min-h-screen bg-secondary py-6 sm:py-8 font-caviardreams\">\n\t\t\t<div className=\"mx-auto max-w-screen-2xl px-4 md:px-8\">\n\t\t\t\t<div className=\"mb-4 text-5xl font-bold sm:text-6xl md:mb-6 text-works grid-cols-2 grid\">\n\t\t\t\t\t<h1 className=\"mb-6 col-span-1 flex items-center\">works</h1>\n\t\t\t\t\t<div className=\"mb-6 flex items-end justify-between gap-4 col-span-1\">\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<Header />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<WorksGrid />\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default WorksPage;\nexport const Head: HeadFC = () => <title>isshin — Works</title>;\n","import { supabase } from \"./supabase\";\r\n\r\ninterface addWorkProps {\r\n\tworkName: string;\r\n\tdate: string;\r\n\turl: string;\r\n\tdescription: string;\r\n\timages: File[];\r\n}\r\n\r\nexport const database = () => {\r\n\tconst addWork = async ({\r\n\t\tworkName,\r\n\t\tdate,\r\n\t\turl,\r\n\t\tdescription,\r\n\t\timages,\r\n\t}: addWorkProps) => {\r\n\t\ttry {\r\n\t\t\tconst { data: id_data, error: id_error } = await supabase\r\n\t\t\t\t.from(\"works\")\r\n\t\t\t\t.select(\"id\")\r\n\t\t\t\t.order(\"id\", { ascending: false })\r\n\t\t\t\t.limit(1);\r\n\t\t\tif (id_error) {\r\n\t\t\t\tthrow new Error(`Error fetching max work id: ${id_error.message}`);\r\n\t\t\t}\r\n\t\t\tconst folder_name = ((id_data?.[0]?.id || 0) + 1).toString();\r\n\r\n\t\t\tconsole.log(id_data);\r\n\t\t\tconsole.log(folder_name);\r\n\r\n\t\t\tconst uploadData: any[] | null = [];\r\n\t\t\tconst uploadPromises = images.map(async (image, index) => {\r\n\t\t\t\tconst { data, error } = await supabase.storage\r\n\t\t\t\t\t.from(\"assets\")\r\n\t\t\t\t\t.upload(`works/${folder_name}/${index}`, image);\r\n\t\t\t\tif (error) {\r\n\t\t\t\t\tthrow new Error(`Error uploading image: ${error.message}`);\r\n\t\t\t\t}\r\n\t\t\t\tuploadData.push(data);\r\n\t\t\t});\r\n\r\n\t\t\tawait Promise.all(uploadPromises);\r\n\r\n\t\t\tconsole.log(uploadData);\r\n\t\t\tconst imagePathList: string[] = uploadData.map((item) => item.fullPath);\r\n\t\t\tconsole.log(imagePathList);\r\n\r\n\t\t\tconst { data, error } = await supabase\r\n\t\t\t\t.from(\"works\")\r\n\t\t\t\t.insert([\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: workName,\r\n\t\t\t\t\t\tdate: date,\r\n\t\t\t\t\t\timage: imagePathList,\r\n\t\t\t\t\t\turl: url,\r\n\t\t\t\t\t\tdescription: description,\r\n\t\t\t\t\t},\r\n\t\t\t\t])\r\n\t\t\t\t.select();\r\n\t\t\tif (error) {\r\n\t\t\t\tthrow new Error(`Error uploading works: ${error.message}`);\r\n\t\t\t}\r\n\t\t\tconsole.log(data);\r\n\r\n\t\t\treturn data;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"An error occurred:\", (error as Error).message);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\tconst getWorks = async () => {\r\n\t\ttry {\r\n\t\t\tconst { data, error } = await supabase.from(\"works\").select(\"*\");\r\n\t\t\tif (error) {\r\n\t\t\t\tthrow new Error(`Error uploading image: ${error.message}`);\r\n\t\t\t}\r\n\t\t\treturn data;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"An error occurred:\", (error as Error).message);\r\n\t\t}\r\n\t};\r\n\r\n\treturn {\r\n\t\taddWork,\r\n\t\tgetWorks,\r\n\t};\r\n};\r\n","interface Work {\n\tdate: string;\n\tpin: boolean\n}\n\nexport const sortByDate = (a: Work, b: Work) => {\n\treturn new Date(b.date).getTime() - new Date(a.date).getTime();\n};\n\nexport const sortByPin = (a: Work, b: Work) => {\n\treturn (a.pin === b.pin) ? 0 : a.pin ? -1 : 1\n}\n"],"names":["_ref","colors","location","useLocation","pathname","replace","React","className","Link","to","includes","WorksGrid","works","setWorks","useState","selectedWork","setSelectedWork","visibleWorks","setVisibleWorks","useEffect","async","getWorks","database","data","sort","sortByDate","sortByPin","console","log","error","message","fetchData","handleScroll","window","innerHeight","document","documentElement","scrollTop","offsetHeight","prevVisibleWorks","addEventListener","removeEventListener","slice","map","work","key","id","onClick","handleImageClick","src","image","alt","name","date","split","join","target","href","url","closeOverlay","loading","WorksPage","Header","Head","addWork","workName","description","images","_id_data$","id_data","id_error","supabase","from","select","order","ascending","limit","Error","folder_name","toString","uploadData","uploadPromises","index","storage","upload","push","Promise","all","imagePathList","item","fullPath","insert","a","b","Date","getTime","pin"],"sourceRoot":""}